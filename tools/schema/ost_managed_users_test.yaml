# Enhanced Schema File for Testing
# Generated by PocketBase Schema Extractor v2.0
# Created: 2025-08-11T00:00:00Z
# Updated: 2025-08-11T00:00:00Z
# Source: Enhanced example for testing
# Description: Test table for enhanced schema functionality

table: ost_managed_users_test
description: "Test table for managed user accounts with enhanced schema features"

fields:
  - name: id
    type: text
    description: "Unique identifier for the managed user record"
    primaryKey: true

  - name: name
    type: text
    description: "Full display name of the user"
    required: true
    validation:
      min: 1
      max: 100

  - name: email
    type: text
    description: "User's email address for authentication and communication"
    required: true
    validation:
      pattern: "^[\\w\\.-]+@[\\w\\.-]+\\.[a-zA-Z]{2,}$"

  - name: password
    type: text
    description: "Encrypted password for user authentication"
    required: true
    validation:
      min: 8

  - name: isActive
    type: integer
    description: "Flag indicating if the user account is active (1) or disabled (0)"
    required: true
    default: 1

  - name: organization
    type: text
    description: "Reference to the organization this user belongs to"

  - name: role
    type: text
    description: "Primary role assignment for this user within the organization"

  - name: status
    type: text
    description: "User account status"
    options:
      values: ["active", "inactive", "pending", "suspended"]
      maxSelect: 1

  - name: emailVisibility
    type: integer
    description: "Controls email visibility: 0=private, 1=public within org, 2=global"
    required: true
    default: 0

  - name: verified
    type: integer
    description: "Email verification status (1=verified, 0=pending verification)"
    default: 0

  - name: tokenKey
    type: text
    description: "Authentication token key for API access"
    required: true

  - name: userName
    type: text
    description: "Unique username for login (alternative to email)"
    validation:
      min: 3
      max: 30
      pattern: "^[a-zA-Z0-9._-]+$"

  # Audit trail fields
  - name: createdAt
    type: text
    description: "Timestamp when the record was created"

  - name: createdBy
    type: text
    description: "User who created this record"

  - name: updatedAt
    type: text
    description: "Timestamp when the record was last updated"

  - name: updatedBy
    type: text
    description: "User who last updated this record"

  - name: deletedAt
    type: text
    description: "Soft delete timestamp (null if not deleted)"

  # Sync metadata fields
  - name: lastSyncedAt
    type: text
    description: "Last successful synchronization timestamp with remote server"

  - name: syncVersion
    type: integer
    description: "Version number for optimistic concurrency control during sync"
    default: 0

  - name: isDirty
    type: integer
    description: "Flag indicating if record has unsynchronized changes (1=dirty, 0=clean)"
    default: 1

  - name: isDeleted
    type: integer
    description: "Soft delete flag for sync purposes (1=deleted, 0=active)"
    default: 0

# Suggested indexes for performance optimization
indexes:
  - fields: [organization]
    name: idx_managed_users_test_organization
  - fields: [email]
    name: idx_managed_users_test_email
    unique: true
  - fields: [isActive, isDeleted]
    name: idx_managed_users_test_active_status
  - fields: [isDirty]
    name: idx_managed_users_test_sync_dirty
